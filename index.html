<!DOCTYPE html>
<html>
  <head>
    <title>2019-nCoV visualizations</title>
    <meta http-equiv="content-type" content="text/html" charset="utf-8" />
    <script lang="javascript" src="./dist/sql-wasm.js"></script>
    <script lang="javascript" src="./dist/d3.v5.min.js"></script>
    <script lang="javascript" src="./dist/moment.min.js"></script>
    <script lang="javascript" src="./dist/moment-strftime.js"></script>
    <script lang="javascript" src="./dist/topojson.min.js"></script>
    <script lang="javascript" src="./queries.js"></script>
    <script lang="javascript" src="./app.js"></script>

    <link rel="stylesheet" type="text/css" href = "styles.css" />

    <script lang="javascript">
      function toggle_region(event) {
        switch (chart.profile) {
          case "china":
            chart.set_profile(db, "all")
            return;
          case "all":
            chart.set_profile(db, "china")
            return;
        }
      }

      const SETTINGS = {
        locale: 'en-US',
        db_path: './data/nCoV.sqlite3',
        topo_path: './data/china-provinces.topo.json',
      }

      let db = new Database(SETTINGS.db_path)
      let chart;

      db.load_data().then((foo) => {
        // Set up our chart
        console.log("Setting up chart")

        chart = new StackedArea()

        window.onresize = function() {
          chart.set_dimensions()
          chart.draw()
        }

        chart.set_profile(db, 'china')
        chart.draw()
      })
</script>
  </head>
  <body>
    <svg class="plot chart"></svg>
    <p style="padding-left: 20px; margin-top: 0">
      Data sourced from Johns Hopkins University's <a href="https://systems.jhu.edu/" target="_blank">Center for Systems Science and Engineering</a>.
      All times local to U.S. East Coast.  Maps are <a href="map.html">over here</a>.
    </p>
    <div class="chart tooltip">
      <span class="tooltip-header">As of <span class="tooltip_updated_at"></span>:</span><br>
      <ul class="tooltip_series">
      </ul>
    </div>
  </body>
</html>
